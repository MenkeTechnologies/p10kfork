#compdef p10k

function _p10k(){

  local arguments verb
  local curcontext=$curcontext state line ret=0 __p10k_commands

  __p10k_commands=(
        'configure:run interactive configuration wizard'
        'reload:reload configuration'
        'segment:print a user-defined prompt segment'
        'display:show, hide or toggle prompt parts'
        'help:print this help message'
    )

  arguments=(
        '1:p10k subcommand:->verb'
        '*:: :->args'
    )

    _arguments -S -s $arguments && return 0

    case $state in
        verb)
            _describe -t p10k-commands "p10k verbs" __p10k_commands && ret=0
            ;;
        args)
            verb=$words[1]
            curcontext="${curcontext%:*:*}:zpwr-$verb:"
            case $verb in
                configure)
                     _message 'no more arguments'
                    ret=1
                    ;;
                reload)
                    _message 'no more arguments'
                    ret=1
                    ;;
                segment)
                    #TODO
                    _zcommand
                    ret=$?
                    ;;
                display)
                    #TODO
                    _zcommand
                    ret=$?
                    ;;
                help)
                    if (( $#words > 2)); then
                        _message 'no more arguments'
                        ret=1
                    fi
                    _describe -t p10k-commands "p10k verbs" __p10k_commands
                    ;;
                *)
                    _message 'unknown p10k command'
                    ret=1
                    ;;
            esac
        ;;
    esac

    return $ret
}

_p10k "$@"
